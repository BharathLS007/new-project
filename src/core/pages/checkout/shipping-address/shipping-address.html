<div class="shipping-address-wrapper">
  <div class="address-list" *ngIf="!showForm && (savedAddresses().length > 0 || true)">
    <div class="addresses-container">
      <!-- Saved Addresses -->
      <div *ngFor="let addr of savedAddresses()" 
           class="address-card"
           [class.selected]="selectedAddress()?.id === addr.id"
           (click)="selectAddress(addr)">
        <div class="card-header">
          <div class="radio-button">
            <div *ngIf="selectedAddress()?.id === addr.id" class="radio-inner"></div>
          </div>
          <div class="address-content">
            <h4>{{addr.name}}</h4>
            <p>{{addr.address}}</p>
            <p>{{addr.city}}</p>
            <p class="phone">{{addr.phone}}</p>
            <span *ngIf="addr.isDefault" class="default-badge">Default Address</span>
          </div>
        </div>
        <div class="card-actions">
          <button type="button" class="btn-action edit" (click)="openForm(addr); $event.stopPropagation()" title="Edit">✎</button>
          <button type="button" class="btn-action delete" (click)="deleteAddress(addr.id); $event.stopPropagation()" title="Delete">✕</button>
        </div>
      </div>

      <!-- Add New Address -->
      <div class="address-card add-new" (click)="openForm()">
        <div class="add-new-content">
          <div class="add-icon">+</div>
          <h4>Add New Address</h4>
          <p>Add a new delivery address</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Address Form -->
  <div class="address-form" *ngIf="showForm">
    <h3>{{editingId ? 'Edit Address' : 'Add New Shipping Address'}}</h3>
    
    <form [formGroup]="addressForm">
      <div class="form-group">
        <label>Full Name</label>
        <input formControlName="name" type="text" placeholder="John Doe" class="form-input" />
        <div class="error" *ngIf="addressForm.get('name')?.touched && addressForm.get('name')?.invalid">
          <span class="error-icon">!</span> Name is required
        </div>
      </div>

      <div class="form-group">
        <label>Street Address</label>
        <input formControlName="address" type="text" placeholder="123 Main Street, Apt 4B" class="form-input" />
        <div class="error" *ngIf="addressForm.get('address')?.touched && addressForm.get('address')?.invalid">
          <span class="error-icon">!</span> Address is required
        </div>
      </div>

      <div class="form-group">
        <label>City / State</label>
        <input formControlName="city" type="text" placeholder="New York, NY" class="form-input" />
        <div class="error" *ngIf="addressForm.get('city')?.touched && addressForm.get('city')?.invalid">
          <span class="error-icon">!</span> City is required
        </div>
      </div>

      <div class="form-group">
        <label>Phone Number</label>
        <input formControlName="phone" type="text" placeholder="+1 (555) 123-4567" class="form-input" />
        <div class="error" *ngIf="addressForm.get('phone')?.touched && addressForm.get('phone')?.invalid">
          <span class="error-icon">!</span> Enter a valid phone number
        </div>
      </div>

      <div class="form-group checkbox">
        <input formControlName="isDefault" type="checkbox" id="isDefault" class="checkbox-input" />
        <label for="isDefault" class="checkbox-label">Set as default address</label>
      </div>

      <div class="form-actions">
        <button type="button" class="btn-primary" (click)="saveAddress()" [disabled]="addressForm.invalid">
          {{editingId ? 'Update Address' : 'Add Address'}}
        </button>
        <button type="button" class="btn-secondary" (click)="closeForm()">
          Cancel
        </button>
      </div>
    </form>
  </div>
</div>
